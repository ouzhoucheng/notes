# 计算机视觉
[TOC]
# 摄像机几何

## 针孔模型&透镜
![在这里插入图片描述](https://img-blog.csdnimg.cn/a7dfed27de2b466cacb401d3f6d84292.png)

$$P=\begin{bmatrix}x \\y \\z\end{bmatrix}\rightarrow 
P'=\begin{bmatrix}x' \\y'\end{bmatrix}~~~~~
\left\{\begin{matrix}x'=f\frac{x}{z}  \\y'=f\frac{y}{z} \end{matrix}\right.
$$

缩小光圈,变清晰,变暗

- 畸变：
  - 径向畸变：枕形畸变、桶形畸变
    光线在远离透镜中心处比靠近中心的地方更弯曲

## 摄像机几何
![在这里插入图片描述](https://img-blog.csdnimg.cn/5e02f12ce8f445c58c84954c87dd3845.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/587bfd0e04b14ba581605e2f3bebde44.png)

$P_{h}^{\prime}=\left[\begin{array}{c}\alpha x+c_{x} z \\\beta y+c_{y} z \\z\end{array}\right]=\left[\begin{array}{cccc}\alpha & 0 & c_{x} & 0 \\0 & \beta & c_{y} & 0 \\0 & 0 & 1 & 0\end{array}\right]\left[\begin{array}{l}x \\y \\z \\1\end{array}\right]=MP$

$\overbrace{P_{h}^{\prime}}^{\text {齐次 }} \rightarrow \overbrace{P^{\prime}=\left(\alpha \frac{x}{z}+c_{x}, \beta \frac{y}{z}+c_{y}\right)}^{\text {欧式}}$

相机偏斜$\theta$,变换坐标
$P^{\prime}=\left[\begin{array}{cccc}\alpha & -\alpha \cot \theta & c_{x} & 0 \\0 & \beta / \sin \theta & c_{y} & 0 \\0 & 0 & 1 & 0\end{array}\right]\left[\begin{array}{l}x \\y \\z \\1\end{array}\right]=MP=K[I~~0]P$

### 内参矩阵
**内参矩阵** $K=\left[\begin{array}{cccc}\alpha & -\alpha \cot \theta & c_{x}  \\0 & \beta / \sin \theta & c_{y}  \\0 & 0 & 1\end{array}\right]$

### 外参矩阵
世界坐标系$P_w=[x_w~y_w~z_w~1]^T$ -> 摄像机坐标系$P$
完整摄像机模型$P^{\prime}=K\left[\begin{array}{ll}I & 0\end{array}\right] P=K\left[\begin{array}{ll}I & 0\end{array}\right]\left[\begin{array}{ll}R & T \\0 & 1\end{array}\right] P_{w}=K[R~~T]P_w=MP_w$
**外参矩阵**$[R~~T]$

![在这里插入图片描述](https://img-blog.csdnimg.cn/96f74683e4ff4d0a8104830a7a2d8249.png)
5相机内参+6相机外参=11自由度

$ M=K[R T]=[K R K T]=\left[\begin{array}{ll}A & b\end{array}\right] $   $~~~A=\left[\begin{array}{l}a_{1}^{T} \\a_{2}^{T} \\a_{3}^{T}\end{array}\right]$

- M=透视投影矩阵 <=> $Det(A)\neq0$
- M=零倾斜透视投影矩阵 <=> $Det(A)\neq0$ & $\left(a_{1} \times a_{3}\right) \cdot\left(a_{2} \times a_{3}\right)=0$
- M=零倾斜,宽高比=1的透视投影矩阵 <=> $Det(A)\neq0$ & $\left\{\begin{array}{c}\left(a_{1} \times a_{3}\right) \cdot\left(a_{2} \times a_{3}\right)=0 \\\left(a_{1} \times a_{3}\right) \cdot\left(a_{1} \times a_{3}\right)=\left(a_{2} \times a_{3}\right) \cdot\left(a_{2} \times a_{3}\right)\end{array}\right.$

## 相机模型

### 透视投影
对3D到2D映射建模更准确,用于运动恢复结构/SLAM
![透视投影](https://img-blog.csdnimg.cn/6d9cb8da4bc04d16a96dbb6d0a325390.png)
$$
\begin{array}{l}
P_{3 \times 1}^{\prime}=M P_{w}=K_{3 \times 3}\left[\begin{array}{ll}
R & T]_{3 \times 4} P_{w 4 \times 1}
\end{array}\right.
=\left[\begin{array}{l}
m_{1} \\
m_{2} \\
m_{3}
\end{array}\right] P_{w}=\left[\begin{array}{l}
m_{1} P_{w} \\
m_{2} P_{w} \\
m_{3} P_{w}
\end{array}\right] \quad \stackrel{E}{\rightarrow}\left(\frac{m_{1} P_{w}}{m_{3} P_{w}}, \frac{m_{2} P_{w}}{m_{3} P_{w}}\right)
\end{array}
$$

$M=\left[\begin{array}{l}m_{1} \\m_{2} \\m_{3}\end{array}\right]$

### 弱透视投影
物体较小较远时准确,用于图像识别任务
![相对场景深度<与相机距离](https://img-blog.csdnimg.cn/aabd0cbb298e4b70b1170460902406b0.png)
投影(透视)->弱透视
$$
M=K\left[\begin{array}{ll}R & T\end{array}\right]=\left[\begin{array}{cc}A_{2 \times 3} & b_{2 \times 1} \\v_{1 \times 2} & 1
\end{array}\right] \quad \rightarrow \quad M=\left[\begin{array}{ll}A & b \\0 & 1\end{array}\right]
$$

![在这里插入图片描述](https://img-blog.csdnimg.cn/c073472729844024b77b32c486141355.png)

### 正交投影
建筑设计/工业设计
![摄像机中心->像平面距离无限远](https://img-blog.csdnimg.cn/a3a459e83ff749ca963d456635429f9b.png)
$$
\left\{\begin{array} { l } { \mathrm { x } ^ { \prime } = \frac { f ^ { \prime } } { z } x} \\{ y ^ { \prime } = \frac { f ^ { \prime } } { z } y }\end{array} \rightarrow \left\{\begin{array}{l}x^{\prime}=x \\y^{\prime}=y\end{array}\right.\right.
$$

# 摄像机标定

## 针孔模型&透镜摄像机标定
标定问题:已知世界坐标系$P_1,P_2...P_n$位置,图像坐标系$p_1,p_2...p_m$位置,计算摄像机内外参数
## 径向畸变的摄像机标定

# 三维重建基础

## 三维重建基础

## 极几何及基础矩阵

## 基础矩阵估计